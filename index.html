<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitFlex - What's Your Dev Power Level?</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { background-color: #0f172a; font-family: 'Roboto', sans-serif; }
        .pixel-font { font-family: 'Press Start 2P', cursive; }
        .card-bg {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            box-shadow: 0 0 20px rgba(56, 189, 248, 0.5);
            border: 2px solid #38bdf8;
        }
        .glow { text-shadow: 0 0 10px #38bdf8; }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="text-white flex flex-col items-center justify-center min-h-screen p-4">

    <div class="text-center mb-8">
        <h1 class="text-4xl md:text-5xl pixel-font text-sky-400 glow mb-4">GitFlex</h1>
        <p class="text-slate-400">Generate your Developer Power Card instantly.</p>
    </div>

    <div class="flex flex-col sm:flex-row gap-4 mb-8 w-full max-w-md">
        <input type="text" id="username" placeholder="GitHub Username (e.g., torvalds)" 
               class="flex-1 p-3 rounded bg-slate-800 border border-slate-600 focus:border-sky-400 focus:outline-none text-white">
        <button onclick="generateCard()" 
                class="bg-sky-500 hover:bg-sky-600 text-white font-bold p-3 rounded transition shadow-[0_0_15px_rgba(56,189,248,0.7)]">
            GENERATE
        </button>
    </div>

    <p id="error" class="text-red-500 hidden mb-4 font-bold"></p>
    
    <div id="loader" class="loader hidden mb-8"></div>

    <div id="card-container" class="hidden relative group cursor-pointer perspective">
        <div id="capture-area" class="card-bg w-[350px] p-6 rounded-xl relative overflow-hidden">
            <div class="absolute top-0 right-0 w-24 h-24 bg-sky-500 blur-[80px] opacity-50"></div>
            
            <div class="flex items-center gap-4 mb-6 relative z-10">
                <img id="avatar" src="" alt="Avatar" class="w-20 h-20 rounded-full border-4 border-sky-400 shadow-lg">
                <div>
                    <h2 id="card-name" class="text-xl font-bold text-white"></h2>
                    <p id="card-handle" class="text-sky-400 text-sm">@username</p>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4 mb-6 relative z-10">
                <div class="bg-slate-800 p-3 rounded border border-slate-700">
                    <p class="text-xs text-slate-400 uppercase">Repos</p>
                    <p id="stat-repos" class="text-xl font-bold text-sky-300">0</p>
                </div>
                <div class="bg-slate-800 p-3 rounded border border-slate-700">
                    <p class="text-xs text-slate-400 uppercase">Followers</p>
                    <p id="stat-followers" class="text-xl font-bold text-purple-300">0</p>
                </div>
            </div>

            <div class="mb-4 relative z-10">
                <p class="text-xs text-slate-400 uppercase mb-1">Class</p>
                <h3 id="dev-class" class="text-2xl pixel-font text-yellow-400 glow">CODE ROOKIE</h3>
            </div>

            <div class="mb-2 relative z-10">
                <div class="flex justify-between text-xs text-slate-400 mb-1">
                    <span>Power Level</span>
                    <span id="power-score">0/9000</span>
                </div>
                <div class="w-full bg-slate-700 rounded-full h-4">
                    <div id="power-bar" class="bg-gradient-to-r from-sky-400 to-purple-500 h-4 rounded-full" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="mt-6 pt-4 border-t border-slate-700 text-center">
                <p class="text-[10px] text-slate-500">Generated by GitFlex.com</p>
            </div>
        </div>
    </div>

    <button id="download-btn" onclick="downloadImage()" class="hidden mt-8 text-sm text-slate-400 hover:text-white underline">
        Download & Share Image
    </button>

    <script>
        async function generateCard() {
            const username = document.getElementById('username').value.trim();
            const errorMsg = document.getElementById('error');
            const loader = document.getElementById('loader');
            const cardContainer = document.getElementById('card-container');
            const downloadBtn = document.getElementById('download-btn');

            if (!username) return;

            // Reset UI
            errorMsg.classList.add('hidden');
            cardContainer.classList.add('hidden');
            downloadBtn.classList.add('hidden');
            loader.classList.remove('hidden');

            try {
                // Fetch GitHub Data
                const response = await fetch(`https://api.github.com/users/${username}`);
                if (!response.ok) throw new Error('User not found!');
                const data = await response.json();

                // Calculate Power Level logic
                const score = (data.public_repos * 5) + (data.followers * 10);
                const powerLevel = Math.min(score, 9000); // Cap at 9000
                const powerPercent = Math.min((score / 5000) * 100, 100);

                // Determine "Class" (Viral Hook)
                let devClass = "SCRIPT KIDDIE";
                if (score > 100) devClass = "BUG HUNTER";
                if (score > 500) devClass = "FULL STACKER";
                if (score > 1000) devClass = "TECH LEAD";
                if (score > 3000) devClass = "10x ENGINEER";
                if (score > 5000) devClass = "CODE GOD";

                // Update UI
                document.getElementById('avatar').src = data.avatar_url;
                document.getElementById('card-name').innerText = data.name || username;
                document.getElementById('card-handle').innerText = `@${data.login}`;
                document.getElementById('stat-repos').innerText = data.public_repos;
                document.getElementById('stat-followers').innerText = data.followers;
                document.getElementById('dev-class').innerText = devClass;
                document.getElementById('power-score').innerText = `${score} / 9000`;
                document.getElementById('power-bar').style.width = `${powerPercent}%`;

                // Show Card
                loader.classList.add('hidden');
                cardContainer.classList.remove('hidden');
                downloadBtn.classList.remove('hidden');

            } catch (err) {
                loader.classList.add('hidden');
                errorMsg.innerText = err.message;
                errorMsg.classList.remove('hidden');
            }
        }

        function downloadImage() {
            const captureElement = document.getElementById('capture-area');
            html2canvas(captureElement, { backgroundColor: null }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'gitflex-card.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }
    </script>
</body>
</html>
